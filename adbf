#!/usr/bin/env bash
# Do an adb operation with a file, pull it, and remove it.

if [ "$#" -lt  2 ]; then
  echo 'Usage: adbf [filename] [commands...]'
  exit 1
fi

filename="/sdcard/$1"
shift

finish() {
  sleep 0.5
  adb pull "$filename"
  adb shell rm "$filename"
}
trap finish EXIT

adb shell "$@" "$filename"
