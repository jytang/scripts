#!/usr/bin/env bash
# Get the currently focused window's title, truncated to 40 characters.
# https://maxammann.github.io/2015/03/07/conky-window-title/

xprop -id \
$(xprop -root | awk '/_NET_ACTIVE_WINDOW\(WINDOW\)/ {print $NF}') |\
awk -v pref=30 -v len=40 '
  /_NET_WM_NAME/ {
    gsub("\\\\", "", $0)
    win_name = substr($0, pref)
    win_name = substr(win_name, 0, length(win_name)-1)
    if (length(win_name) > len)
      print substr(win_name, 0, len-1) "â€¦"
    else
      print win_name
  }
'

